{% extends "base.html" %}

{% block core %}
<div class="core_title">
  <h1>Remove Contest</h1>
</div>

{% if admin.permission_all %}
<p>
  Are you sure you want to remove contest {{ contest.name }} from CMS?
  <br>
  <strong>Warning:</strong> This will remove {{ contest.participations|length }} participation(s) and {{ submission_count }} submission(s){% if task_count > 0 %}, regardless of the option you choose below{% endif %}.
  <br>
  This operation cannot be undone.
</p>

{% if task_count > 0 %}
<p>
  The contest has {{ task_count }} task(s). Please choose what to do with them:
</p>

<div style="margin: 20px 0;">
  <label style="display: block; margin-bottom: 10px;">
    <input type="radio" name="action" value="move" id="action_move">
    Move all tasks to another contest:
    <select name="target_contest_id" id="target_contest_select" style="margin-left: 10px;">
      <option value="">Select a contest</option>
      {% for c in other_contests %}
      <option value="{{ c.id }}">{{ c.name }}</option>
      {% endfor %}
    </select>
  </label>
  
  <label style="display: block; margin-bottom: 10px;">
    <input type="radio" name="action" value="detach">
    Remove tasks from contest but keep them in the system (tasks will not belong to any contest)
  </label>
  
  <label style="display: block; margin-bottom: 10px; color: red; font-weight: bold;">
    <input type="radio" name="action" value="delete_all">
    Delete all tasks from the system
  </label>
</div>
{% endif %}

<br>
<a onclick="doRemove();" class="button-link">Yes, remove contest</a>
<a href="{{ url("contests") }}" class="button-link">No, cancel</a>

<script>
CMS.AWSUtils.initRemovePage({
  removeUrl: '{{ url("contests", contest.id, "remove") }}',
  hasTaskOptions: {{ 'true' if task_count > 0 else 'false' }},
  targetSelectId: 'target_contest_select',
  targetParamName: 'target_contest_id',
  targetLabel: 'contest'
});
</script>

{% else %}
You do not have permission to remove a contest.
{% endif %}

{% endblock core %}
