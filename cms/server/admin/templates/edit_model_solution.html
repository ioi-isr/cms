{% extends "base.html" %}

{% block core %}
<div class="core_title">
  <h1><a href="{{ url("task", task.id) }}">{{ task.title }} ({{ task.name }})</a> - Edit Model Solution</h1>
</div>
<form action="{{ url("model_solution", meta.id, "edit") }}" method="POST">
  {{ xsrf_form_html|safe }}
  <table>
    <tr>
      <td>Description:</td>
      <td><input type="text" name="description" value="{{ meta.description }}" required /></td>
    </tr>
    <tr>
      <td>Expected Score Min:</td>
      <td><input type="number" step="0.01" name="expected_score_min" value="{{ meta.expected_score_min }}" required /></td>
    </tr>
    <tr>
      <td>Expected Score Max:</td>
      <td><input type="number" step="0.01" name="expected_score_max" value="{{ meta.expected_score_max }}" required /></td>
    </tr>
{% if subtasks %}
    <tr>
      <td colspan="2"><strong>Expected Subtask Scores:</strong></td>
    </tr>
    <tr>
      <td colspan="2">
        <table class="bordered" style="text-align:center; margin-top: 5px;">
          <thead>
            <tr>
              <th>Subtask</th>
              <th>Expected Min</th>
              <th>Expected Max</th>
            </tr>
          </thead>
          <tbody>
{% for st in subtasks if st.max_score > 0 %}
{% set st_key = st.idx|string %}
{% set current_min = meta.subtask_expected_scores[st_key].min if meta.subtask_expected_scores and st_key in meta.subtask_expected_scores else 0 %}
{% set current_max = meta.subtask_expected_scores[st_key].max if meta.subtask_expected_scores and st_key in meta.subtask_expected_scores else st.max_score %}
            <tr>
              <td>{{ st.display_name }}</td>
              <td><input type="number" step="0.01" name="subtask_{{ st.idx }}_min" value="{{ current_min }}" style="width: 80px;" /></td>
              <td><input type="number" step="0.01" name="subtask_{{ st.idx }}_max" value="{{ current_max }}" style="width: 80px;" /></td>
            </tr>
{% endfor %}
          </tbody>
        </table>
      </td>
    </tr>
{% endif %}
  </table>
  <input type="submit" value="Update">
  <input type="reset" value="Reset">
</form>
{% endblock core %}
