{# This snippet shows a form to edit a hashed password for users and participations. #}

{% if hashed_password is not none %}
  {% set method, password = parse_authentication(hashed_password) %}
{% else %}
  {% set method = "plaintext" %}
  {% set password = "" %}
{% endif %}

<input type="password" name="password" id="password-field" value="{{ password if method == "plaintext" else "" }}" />
<select name="method">
  <option value="plaintext" {{ "selected" if method == "plaintext" else "" }}>Plain text</option>
  <option value="bcrypt" {{ "selected" if method == "bcrypt" else "" }}>Hashed (bcrypt)</option>
</select>
<div id="password-strength-container" style="margin-top: 5px;">
  <div id="password-strength-bar" style="height: 5px; border-radius: 3px; transition: all 0.3s ease; display: none;"></div>
  <span id="password-strength-text" style="font-size: 12px;"></span>
</div>
<script>
  CMS.AWSUtils.initPasswordStrength(
    "#password-field",
    "#password-strength-bar",
    "#password-strength-text"
  );
</script>
{% if method != "plaintext" %}
<script>
  $("[name=method]").change(function (e) {
    if (e.target.value != "{{ method }}") {
      $("[name=password]").attr("placeholder", "");
    }
    else {
      $("[name=password]").attr("placeholder", "The password is hashed, type a new one in here to change it");
    }});
  $("[name=method]").change();
</script>
{% endif %}

