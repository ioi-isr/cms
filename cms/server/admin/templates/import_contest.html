{% extends "base.html" %}

{% block core %}
<div class="core_title">
  <h1>Import Contest</h1>
</div>

<form enctype="multipart/form-data" action="{{ url("contests", "import") }}" method="POST">
  {{ xsrf_form_html|safe }}
  
  <h2>Upload Contest Archive</h2>
  <p>Upload a zip file containing the contest data in a supported format (Italian YAML, Polygon).</p>
  
  <div style="margin: 20px 0;">
    <label for="contest_file"><strong>Contest Archive (ZIP):</strong></label><br/>
    <input type="file" name="contest_file" id="contest_file" accept=".zip" required/><br/>
  </div>
  
  <h2>Import Options</h2>
  
  <div style="margin: 10px 0;">
    <label>
      <input type="checkbox" name="import_tasks" value="true"/>
      Import tasks if they do not exist in the database
    </label>
  </div>
  
  <div style="margin: 10px 0;">
    <label>
      <input type="checkbox" name="update_contest" value="true"/>
      Update existing contest (if contest with same name exists)
    </label>
  </div>
  
  <div style="margin: 10px 0;">
    <label>
      <input type="checkbox" name="update_tasks" value="true"/>
      Update existing tasks
    </label>
  </div>
  
  <div style="margin: 10px 0;">
    <label>
      <input type="checkbox" name="no_statements" value="true"/>
      Do not import task statements
    </label>
  </div>
  
  <div style="margin: 10px 0;">
    <label for="loader"><strong>Loader (optional, autodetect if empty):</strong></label><br/>
    <select name="loader" id="loader">
      <option value="">-- Autodetect --</option>
      <option value="italy_yaml">Italian YAML</option>
      <option value="polygon">Polygon</option>
    </select>
  </div>
  
  <div style="margin: 20px 0;">
    <input type="submit" value="Import Contest">
    <input type="button" value="Cancel" onclick="window.location.href='{{ url("contests") }}'">
  </div>
</form>

<div style="margin-top: 30px; padding: 10px; background-color: #f0f0f0; border: 1px solid #ccc;">
  <h3>Supported Formats</h3>
  <ul>
    <li><strong>Italian YAML:</strong> Contest directory with contest.yaml file</li>
    <li><strong>Polygon:</strong> Codeforces Polygon XML format</li>
  </ul>
  <p>The zip file should contain the contest directory structure. If the zip contains a single top-level directory, that directory will be used as the contest root.</p>
  <p><strong>Note:</strong> Users and teams referenced in the contest must already exist in the database. Use cmsImportUser and cmsImportTeam to import them first if needed.</p>
</div>

{% endblock core %}
